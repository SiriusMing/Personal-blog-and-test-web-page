## Introduction

### Main style and content introduction

​	This project is a personal website built using Node.js, Express.js, and Socket.IO, integrating static file services, homepage routing, and real-time bidirectional communication. The main features of the project include:

- **Static File Service**: Provided through the `static` middleware of Express.js, which includes static resources such as HTML, CSS, JavaScript, and images, ensuring that users can smoothly access various parts of the website.
- **Homepage Routing**: A simple GET route is defined to return the HTML file of the homepage, serving as the entry point of the website.
- **Real-time Bidirectional Communication**: Implemented using Socket.IO, allowing real-time message transmission between the server and clients, with terminal output prompts for easy monitoring, especially for handling interactive quiz functionalities. All connected clients are stored in an array, supporting message broadcasting and handling user disconnections.

​	This website consists of seven pages, five of which are static content pages for the personal blog. Apart from the homepage, the other pages are statically implemented. The remaining two pages are dynamically implemented quiz pages, designed to meet the basic operational requirements for conducting tests.

​	![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/1.png?raw=true)



​	The page's style meets the requirements of sensible padding, responsive layout, and consistency in design, achieved through CSS styles. The design of the HOME PAGE utilizes Bootstrap[^1] and Bootstrap Icon[^2] along with related CSS libraries and JavaScript code, including relevant JavaScript libraries, to implement dynamic delayed animation effects. Similarly, to ensure style consistency, different block components are primarily used to construct the layout of the page, and the three INTEREST pages also utilize the same CSS file to ensure uniformity in this section's style.

​	All pages adhere to an external color palette[^3] as a reference. The palette consists of warm tones with a light bias, and all pages are color-coordinated based on this foundation.

​	![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/2.png?raw=true)

### 	Instructions for use and files(folders)

​	Running my webpage is very easy, just execute the command 

```sh
npm start
```

 in the root directory: "webpage". Since the project has a valid package.json file that contains the content that defines the start script. After that, you can connect to the server, and the webpage can send HTTP requests to the server. The server will then execute the corresponding handling functions based on the requested path and method, thus meeting the webpage's requirements. (Remember to wait for all components to load the first time)

​	Certainly, prior to this, it is essential to ensure that all necessary packages have been downloaded within the Codio environment. To achieve this, execute the following commands sequentially:

- ```shell
  cd webpage/
  ```

- ```shell
  npm install
  ```

- ```shell
  npm install express
  ```

- ```shell
  npm install socket.io  / npm i socket.io-client  (choose the first one or install both)
  ```

- ```sh
  npm i bootstrap-icons
  ```

​	The directory you can see using `npm ls` should look like this:

```shell
codio@drinkunique-chaosgolf:~/workspace/webpage$ npm ls
webpage@1.0.0 /home/codio/workspace/webpage
├── bootstrap-icons@1.11.3
├── express@4.19.2
├── socket.io-client@4.7.5
└── socket.io@4.7.5
```

​	In terms of the number of files, while there are relatively many files and folders, the structure is constructed reasonably.

​	![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/3.png?raw=true)

- **package.json**: This file contains metadata about the project and its dependencies.
- **package-lock.json**: This file is automatically generated by npm and is used to lock down the versions of dependencies installed in the project.
- **server.js**: This file is the main server file for the application. It typically contains the code to create and configure the server using frameworks: Express.js.
- **public folder**: Files that store the rest of the static resources and dynamic resources, including html files, css style files, js files, etc.

​	![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/4.png?raw=true)

- **Folder description(Explain from top to bottom):**
  - For the css folder, the css style is placed in all the content about the personal blog.
  - For the data folder, this folder prevents the json question bank document needed for the quiz page and a txt file to store the user's answers.
  - For html documents, there are personal blog pages in addition to the HOME PAGE.
  - For the img folder, this is where all the local images used by the home page are placed.
  - The js folder is the js library used by the home page.
  - The quiz folder is the js file needed to make the quiz page.
- **Other files:** Html files and css style files for other pages, and index.js encapsulates all the logic and functionality associated with the quiz setup, making the main page code more concise and manageable by providing a clean API for managing quiz configurations.



​	The following part will offer more details.

------

## Personal website design

### 	Design of Home page

​		Files correspond to: `index.html`,js folder, img folder,`server.js`, `detail.css`, `frame.css` and `three-party.css`, a three-party CSS style that integrates a lot of css styles. `index.html` is a page file, detail.css and frame.css are used to beautify the layout of page structure and effect respectively, while three-party.css is a css library from Bootstrap and github[^4], and the js folder is a js library provided Bootstrap JavaScript, JQuery. It is used to ensure the realization of the desired dynamic effect.

- **Used external library**
  - Popper.js[^5] is a library for creating pop-up tooltips and pop-up menus. In this case, it is used as a pop-up effect when the navigation bar starts to display (since using the style.css library, this effect will be displayed when the window is large enough).
  - Bootstrap[^6] is a popular front-end framework that provides a ready-made set of CSS styles and JavaScript components for  building responsive, mobile-first websites and web applications. This page Bootstrap framework provides a set of vector ICONS for icon display in the website. 
  - Swiper[^7] is a popular modern carousel library for creating responsive, touch-and-slide carousel effects. swiper is used to ensure that the two slides slide horizontally, as well as the button click after sliding down.

​	The home page can be viewed as an introduction page with a navigation bar above it to facilitate access to other pages. The details is as follows:

- **The content**

  - It mainly consists of two parts: the header part and the content part.

  - **A navigation bar** is provided in the header section, including links such as "Home", "About", "Interests" (with drop-down options "Anime", "Astronomy" and "Poet"), and "Quiz" for quick access.

  - A web content area with a profile and images designed to showcase an individual's background, studies, non-academic skills, and interests. A music introduction section, which contains the introduction of the six songs, pictures, and play links, and a part about chocolate, both of which correspond to what the ABOUT PAGE will say.

  - Use several different types of containers to store page content from Bootstrap.
   ```html
  <section id="content" class="bg-white">
                      <div id="iny93b" class="content-wrap pt-0 c10974">
                          <div class="position-relative">
                              <div class="container">
  ```
  
  - Use several utility classes, Bootstrap grid, etc to adjust various CSS properties from Bootstrap. You can see more of the rest of Bootstrap usage in `index.html`.

```html
  <div class="row py-0 py-lg-5">
                                      
     <div class="col-lg-5 py-5">
                                         
         <div id="section-about" class="heading-block border-bottom-0 mb-4">
                                             
             <div class="fancy-title title-border mb-3">
```

  - A picture wall presented in the form of waterfall flow, the content of the picture wall is about the INTEREST part, and the icon of bootstrap is also used here.

    - ```css
      /* Waterfall flow layout style */
      .text-title {
          margin-bottom: 20px; 
      }
      
      .text-title h4{
          color: #E8E8E4;
      }
      
      /*Create a waterfall effect*/
      .masonry-thumbs {
          margin-top: 20px; 
          
      }
      
      .masonry-thumbs .grid-item {
      	display: block;
      	border-right: 2px solid #FFF;
      	border-bottom: 2px solid #FFF;
      	padding: 0;
      	border-radius: 4px;
      }
      
      .masonry-thumbs .grid-item img {
      	transform:  scale(1.05) translateX(-2px) translateY(-2px);
      	transition: all .5s ease-out;
      	padding: 0;
      }
      
      .masonry-thumbs .grid-item:hover img {
      	transform: scale(1.05) translateX(2px) translateY(2px);
      	filter: sepia(0) saturate(1.3);
      	opacity: .9;
      }
      ```

      Used to create a waterfall flow layout and define the mesh items and the styles of the images in them, as well as the interaction effects when the mouse is hovering.

  - A video page introduces the main content of the quiz, Footnotes are also provided.

- **The implementation of dynamic effects in css**

  - ```css
    /* Defines a keyframe animation named fadeInUp */
    @keyframes fadeInUp {
    	/*Initial state*/
      from {
    	opacity: 0;
    	transform: translate3d(0, 50px, 0);
      }
    }
    
    @keyframes fadeInUp {
      from {
    	opacity: 0;
    	transform: translate3d(0, 50px, 0);
      }
    }
    ```

    A keyframe animation named fadeInUp is defined to implement the fade in and fade out effect of elements and move up. This will be applied to the welcome part of the head, and it will have the following effect:

    ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/5.png?raw=true)

    The page is roughly as follows:

    ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/6.png?raw=true)

    All pages are designed with a responsive layout in mind (as shown below). When the screen is relatively small, the layout will be reasonable.

    ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/7.png?raw=true)

    

1. The image automatically resizes to fit when the window is smaller

![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/8.png?raw=true)

2. Similarly, different block components adjust their positions according to the size of the window.

![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/9.png?raw=true)

### 	Design of About page

​		The purpose of the page is to show some personal preferences, memories and stories related to music and chocolate, as well as favorites and recommendations for specific bands and songs. This page should be `about.css` and `about.html`.

- **Page design brief**

  - There are two main blocks in the page, Content-top and Content-bottom, representing the top and bottom content of the page, respectively. At the same time, different fonts, sizes and colors are used to distinguish the content of different elements, and different colors and styles are used to highlight the key points.
  - A shadow effect is used on the image, which is set by the box-shadow property to give the image a three-dimensional feel in the page. The grid layout is also used to arrange the different elements in the page, with attributes such as float: left and display: block controlling their position and arrangement.
  - The page layout style appears as follows:
  
    - ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/10.png?raw=true)

- **Responsive layout**

  - This page also uses a responsive layout to ensure that it can be adapted to the screen in different sizes.

    - ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/12.png?raw=true)

  - One of the code shows:

    - ```css
      /*  GO FULL WIDTH AT LESS THAN 640 PIXELS */
      @media only screen and (max-width: 640px) and (min-width: 480px) {
      	.wrap{
      		width:95%;
      	}
      	.col_1_of_3{ 
      		margin: 1% 0 1% 0%;
      	}
          .col_1_of_bottom{ 
      		margin: 1% 0 1% 0%;
      	}
      	.span_1_of_bottom {
      		width:94%;
      	}
      	.span_1_of_3 {
      		width:94%;
      	}
      }
      ```

      

### 	Design of Interest page

​			This page covers: `interest.css`, `1.html`, `2.html`, `3.html`. This section is about three hobby pages that use the same css style file to meet the overall unity.

​	A variety of methods are used to design the page. It includes setting the layout, layout, style of the elements and the overall structure of the page. The flexibility and variety of the page layout is achieved by using the float property to control the float of the element and the margin property to set the margin of the element. At the same time, the text, title, list, picture and other elements have been detailed style Settings, including font, color, background, etc., to improve the visual effect of the page and user experience. This CSS file also defines multiple ids and classes, and uses pseudo-classes and pseudo-elements to provide a rich selection of styles for different parts and states of the page, giving the page a structured, beautiful look.

- ​	**Responsive layout**
  - These pages also uses a responsive layout to ensure that it can be adapted to the screen in different sizes.
    - ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/14.png?raw=true)

------

## Quiz design

### 	Design of Entry page

​	This page covers `entry.html` and `styles.css`, bootstrap's external css style library[^8] is also used on this page. The design of this page is a user entry page with a modern and responsive design style. It takes advantage of the different features of CSS and HTML to create a beautiful and user-friendly interface.
​	This page is about the login page, the user enters their user name here, the top left corner can go back to the home page.

- **Design layout**

  - Left side section: Contains a link back to the home page and a contact form. The contact form contains an input field and a submit button where the user can enter their name.

  - Right side section: Contains a background video and some text content that welcomes the user and directs them to the quiz section. Background videos play automatically, loop, and mute.

  - The global font is set to "Maiandra GD", a handwritten style font.

  - The page contains a simple JavaScript function store() that stores the user name entered into localStorage so that the user's name can be accessed on subsequent pages.

    - ```javascript
              //to store the user name
              function store()
              {
                  let username = '';
                  const usernameInput = document.getElementById('username');
                  username = usernameInput.value;
                  localStorage.setItem('username', username);
              }
      ```

      

- **Responsive layout**
  - This page also uses a responsive layout to ensure that it can be adapted to the screen in different sizes.
    - ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/15.png?raw=true)

### 	Design of Quiz page

​		This page deals with: `mainpage.html` (dynamic page), `styles1.css`the four js files in quiz folder(`final.js`, `question.js`, `quiz.js`, `setting.js`),`server.js`, a js file named `index.js` to encapsulates all setup related functions, making the main page code more concise and easy to manage and the data folder that stores questions and user responses (leaderboards).

​		In the server, an interactive WebSocket-based quiz web page is implemented, and the server uses Express and Socket.IO to handle client requests and real-time communications.

​	    This quiz completed all the requirements and its content is about a game named: Blue Archive. There are four schools to choose from, each corresponding to different questions in different college json file. The user can choose the number of questions: between 10-15. The final list is sorted according to the shortest average time for equal accuracy. The top right corner shows the number of completed problems (a problem is completed when the next button is pressed) and the total number of problems.

- **Layout design**

  - ​	The web page provides an overall consistent, clean and beautiful design. It simplifies the management of colors and fonts by defining root theme variables. The page layout uses a modern flex layout with background images and font styles, and is responsive to different devices. The various buttons, selection boxes, text and titles have been carefully designed with clear visual layers and hover effects. In addition, check boxes and tables are customized to make the entire page look consistent.

- **Communication between the server and the client based on Socket.io** 

  - **Basic server Settings**

    - Basic server Settings:

      - Create an application instance using express and set up cross-domain.
      - Use `express.static` middleware to provide static files.
      - Use `express.json` middleware to parse JSON-formatted data in the request body.
      - The path for reading and writing leaderboard data is defined as `leaderboardFilePath`.

    - Processing leaderboard data:

      - `POST /saveLeaderboard`: Saves leaderboard data to a file. The existing data is read first, the new data is merged and sorted by score, and then written to the file.
      - `GET /getLeaderboard`：Gets leaderboard data and returns it in `JSON` format.

    - Socket.io server:

      - Create and start the HTTP server and Socket.IO server.

      - Handle client connection and disconnection events.

      - Handles the `collegeQuestion` event, reads the corresponding quiz question based on the requested college ID and sends it to the client.

      - Handles message events and sends the requested test questions to the client.
        Process the answer event, determine whether the answer submitted by the client is correct, and send the result.

      - ```javascript
        const server = http.createServer(app);
        const socketServer = new Server(server);
        
        socketServer.on("connection", function (client) {
          console.log('Client connected');
          let questionData = [];
        
          const findIndexAsync = async (data) => {
            return new Promise(resolve => {
              const index = questionData.questions.findIndex(item => item.question == data.question && item.correctanswer === data.answer);
              resolve(index);
            });
          };
        
          client.on('collegeQuestion', async data => {
            let collegeId = data;
            const url = `./public/data/college_${collegeId}.json`; // Use a local JSON file
            const questions = fs.readFileSync(url);
            questionData = JSON.parse(questions);
            client.emit('question', questionData.questions[0]);
          });
        
          client.on('message', (data) => {
            console.log('Received data from client:', data);
            client.emit('chat_message', questionData.questions[data]);
            // This is where client data can be processed and recovered
          });
        
          client.on('answer', async (data) => {
            const index = await findIndexAsync(data);
            const msg = index == -1 ? 'Wrong answer :(' : 'Correct answer :)';
            client.emit('chat_result', msg);
            console.log('Server is judging the answer');
          });
        
          client.on('disconnect', () => {
            console.log('Client disconnected');
          });
        });
        
        // Specify the server port
        const PORT = 3000;
        // Event listener
        // Start the server and listen on the specified port
        server.listen(PORT, () => {
          console.log(`Server is running on http://localhost:${PORT}`);
        });
        
        ```

        

  - **Client side (HTML & JavaScript)**

    - Create a Socket.IO client to connect to the server.

    - Listens for the disconnect event of the server and prints the disconnect information.

    - Send the College ID request to the server with the appropriate question.

    - Listen for problems returned by the server and display them on the page.

    - Send the answer to the server and receive the judgment result.

    - ```javascript
      // TODO: connect to the address that is currently deployed in codio.
        //var socket = io.connect("https://drinkunique-chaosgolf-3000.codio-box.uk");
         var socket = io.connect();
      // Listen for disconnection events from the server
      socket.on('disconnect', function () {
        console.log('Disconnect');
      });
      
      // Listen for question data from the server
      socket.on('question', function (data) {
        // Display the question received from the server
        document.getElementById('question').innerText = data.question;
        document.getElementById('a1').innerText = data.options[0];
        document.getElementById('a2').innerText = data.options[1];
        document.getElementById('a3').innerText = data.options[2];
        document.getElementById('a4').innerText = data.options[3];
      });
      
      // Send college ID to server to get questions
      document.getElementById('start').addEventListener('click', function () {
        var collegeId = document.getElementById('college').value;
        socket.emit('collegeQuestion', collegeId);
      });
      
      // Send answer to the server and receive result
      document.getElementById('next').addEventListener('click', function () {
        var selectedOption = document.querySelector('input[name="radio"]:checked').nextSibling.textContent;
        var currentQuestion = document.getElementById('question').innerText;
        socket.emit('answer', { question: currentQuestion, answer: selectedOption });
      
        socket.on('chat_result', function (msg) {
          document.getElementById('result').innerText = msg;
        });
      });
      
      ```

      

  - Sample event flow:

  1. The user selects the college and the number of questions and clicks "Start Quiz".

       ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/19.png?raw=true)

  2. The client sends a `collegeQuestion` event to the server, requesting a question for the corresponding college.

       

  3. The server reads the corresponding question file and sends the first question to the client.

       

  4. The user answers the question and submits it, and the client sends the answer event to the server.

      ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/20.png?raw=true)

  5. The server determines whether the answer is correct and sends the result to the client.

       

  6. Repeat Steps 4-5 until the user has completed all questions. And the thoughtful setting if the user empty the option will pop up the alert window to alert. If the timer ends, it will judge the user's error by the way of false answers and jump to the next page.

```javascript
  nextQuestion() {
    // Gets the answer element selected by the user
    const checkedElement = this.questions.answerElements.filter((el) => {
      const dom = el.querySelector('input[type="radio"]');
      //console.log('chec', dom && dom.checked, dom)
      return dom && el.querySelector('input[type="radio"]').checked;
    });
    //console.log('111', checkedElement, this.questions)

    // debugger
    if (checkedElement.length == 0) {
      if (!this.questions.timedOut) {
        alert("You need to select an answer"); //Pop-up prompt window
      } else {
        const fakeCheckedElement = [
          {
            textContent: "", //Setting false answers to directly judge the user is wrong
          },
        ];

        this.showResult(fakeCheckedElement);
      }
    } else {
      this.questions.stopTimer();
      if (this.questions.answer(checkedElement)) {
        this.correctTotal += 1
      };
      this.showResult(checkedElement);
    }
    this.questions.timedOut = false; // Reset timedOut flag
  }
  ```

  7. Users view final scores and leaderboards.

      ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/21.png?raw=true)

      ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/22.png?raw=true)

- **Responsive layout**
  - This page also uses a responsive layout to ensure that it can be adapted to the screen in different sizes.
    - ![If the picture does not appear, please turn on the vpn](https://github.com/SiriusMing/web-picture/blob/main/picture/16.png?raw=true)


------

##  Reference

[^1]: Bootstrap:https://getbootstrap.com/
[^2]: Bootstrap Icon Library:(https://icons.bootcss.com/)
[^3]: Palette[Palette - Coolors]:(https://coolors.co/palette/fec5bb-fcd5ce-fae1dd-f8edeb-e8e8e4-d8e2dc-ece4db-ffe5d9-ffd7ba-fec89a)
[^4]: This is a css three-party library:   https://getbootstrap.com/ https://github.com/nickpettit/glide*
[^5]: Popperjs:https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js
